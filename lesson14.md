# Лекция 14. Imports. Standard library. PEP8.

![Python-Imports.webp](image/Python-Imports.webp)

## Импорты в Python

В Python очень много встроенных возможностей, которые помогают нам решать задачи, не изобретая велосипед. Вместо того чтобы писать код с нуля, мы можем импортировать уже готовые решения.

### Что такое модуль в Python?

**Модуль** — это файл с расширением .py, который содержит функции, классы и переменные, предназначенные для повторного использования.

Простой модуль:

Допустим, у нас есть файл `math_operations.py` с функциями:

```python
# math_operations.py
def add(a, b):
    return a + b

def subtract(a, b):
    return a - b
```
Теперь этот модуль можно импортировать в другой файл и использовать его функции:

```python
import math_operations

result = math_operations.add(10, 5)
print(result)  # 15
```

**Зачем использовать модули?**

- Разделение кода – каждый модуль отвечает за свою задачу.
- Повторное использование – можно подключить один модуль в разных местах.
- Упрощение отладки – легче находить ошибки в отдельных файлах.

Python предоставляет множество встроенных модулей (библиотек), которые входят в стандартную библиотеку. Они позволяют работать:
- с датой и временем
- с математическими вычислениями
- с файловой системой
- с случайными числами
- и со многими другими вещами!

Но прежде чем использовать их, Python должен знать, где они находятся. Именно для этого мы используем ключевые слова `import` и `from`, которые позволяют подключать модули в код.

**Как импортировать модули?**

Существует несколько способов импорта модулей:

**1. Импорт всего модуля (import module)**

Если нам нужен весь модуль, импортируем его так:

```python
import math  # Подключаем модуль math

print(math.sqrt(25))  # 5.0
print(math.pi)        # 3.141592653589793
```

Здесь `math.sqrt(25)` использует квадратный корень, а `math.pi` — это константа π.

Важно: при таком импорте нужно указывать название модуля перед его функциями (`math.sqrt`, `math.pi`).

**2. Импорт конкретных элементов (from module import item)**

Если нам нужно только несколько функций или переменных из модуля, можно импортировать их отдельно:

```python
from math import sqrt, pi

print(sqrt(25))  # 5.0
print(pi)        # 3.141592653589793
```

Теперь мы можем использовать `sqrt()` и `pi` без указания math..

Минус такого подхода: если у вас есть своя функция `sqrt`, это может вызвать путаницу!

**3. Импорт с псевдонимом (import module as alias)**

Если название модуля длинное, его можно сократить:

```python
import random as rnd  # Теперь модуль random доступен как rnd

print(rnd.randint(1, 10))  # Случайное число от 1 до 10
Здесь random.randint(1, 10) заменен на rnd.randint(1, 10), что удобнее при частом использовании.
```

**4. Импорт всех элементов модуля (from module import)**

Можно импортировать все функции и переменные из модуля:

```python
from math import *  # Импортируем всё из math

print(sqrt(16))  # 4.0
print(sin(0))    # 0.0
print(pi)        # 3.141592653589793
```

Но этот способ **НЕ РЕКОМЕНДУЕТСЯ!!!!**, так как он может затереть имена ваших переменных!

```python
from math import *
from statistics import *

print(mean([1, 2, 3]))  # Какой mean()? Из math или statistics?
```

Лучше всегда импортировать конкретные функции или модуль целиком!

### Что такое `__init__.py`?

Файл `__init__.py` делает папку модулем (пакетом). Без него Python не считает папку модулем, и импорт из неё не будет работать.

Пример работы `__init__.py`

Допустим, у нас есть папка `utils/`, в которой лежат модули:

```css
project/
│── main.py
│── utils/
│   ├── __init__.py
│   ├── math_operations.py
│   ├── string_operations.py
```

Файл `utils/__init__.py` может быть пустым или содержать код, например:

```python
# utils/__init__.py
print("Пакет utils загружен!")

# Импортируем сразу все модули пакета
from .math_operations import add, subtract
from .string_operations import capitalize
```

Теперь мы можем импортировать `utils` как пакет:

```python
import utils  # При импорте сразу выполнится print()

print(utils.add(5, 10))  # 15
print(utils.capitalize("python"))  # "Python"
```

### Специфичное значение конструкции `if __name__ == '__main__':`

В Python специальная переменная `__name__` содержит имя текущего модуля. Когда скрипт запускается как основная
программа, `__name__` имеет значение `'__main__'`. Это позволяет писать код, который будет выполняться только в случае,
если скрипт запущен напрямую, а не импортирован как модуль.

**Пример:**

Создадим файл `example.py`:

```python
# example.py
def main():
    print("Это главный скрипт.")


if __name__ == '__main__':
    main()
```

Если вы запустите `example.py`, вы увидите вывод "Это главный скрипт.". Но если вы импортируете этот файл как модуль в
другом скрипте:

```python
# another_script.py
import example
```

Никакой вывод не произойдет, так как `main()` не будет вызван.

> Используем для того что бы отделить между собой основной файл и второстепенные модули

### Работа с встроенными модулями Python

#### Дата и время (datetime)

Модуль `datetime` позволяет работать с датами, временем и форматированием.

```python
from datetime import datetime, timedelta

# Получаем текущую дату и время
now = datetime.now()
print("Сейчас:", now)  # Например: 2025-02-23 15:30:45.123456

# Форматирование даты
formatted = now.strftime("%d.%m.%Y %H:%M:%S")
print("Отформатированная дата:", formatted)  # 23.02.2025 15:30:45

# Вычисления с датами
tomorrow = now + timedelta(days=1)
print("Завтра будет:", tomorrow.strftime("%d.%m.%Y"))
```

#### Математические вычисления (math)

Модуль `math` содержит множество полезных математических функций.

```python
import math

# Константы
print("Число Пи:", math.pi)
print("Число e:", math.e)

# Тригонометрия
angle = math.radians(90)  # Перевод градусов в радианы
print("Синус 90 градусов:", math.sin(angle))  # 1.0

# Округления и корень
print("Квадратный корень из 16:", math.sqrt(16))  # 4.0
print("Округление 3.7 вниз:", math.floor(3.7))  # 3
print("Округление 3.2 вверх:", math.ceil(3.2))  # 4
```

#### Работа с файловой системой (os, shutil)

Модуль `os` помогает управлять файлами и папками, а `shutil` используется для их копирования и удаления.

```python
import os
import shutil

# Получаем текущую директорию
current_dir = os.getcwd()
print("Текущая папка:", current_dir)

# Создание папки
os.mkdir("new_folder")
print("Папка 'new_folder' создана!")

# Переименование папки
os.rename("new_folder", "renamed_folder")
print("Папка переименована в 'renamed_folder'!")

# Удаление папки
os.rmdir("renamed_folder")
print("Папка удалена!")

# Копирование файла
shutil.copy("example.txt", "backup_example.txt")
print("Файл скопирован в 'backup_example.txt'!")

# Проверка существует ли файл или папка. Возвращает True, False
os.path.exists("example.txt") # Проверка файла
os.path.exists("example_folder") # Проверка папки
```

#### Генерация строковых значений

Модуль `string` в Python предоставляет набор предопределённых строковых констант, функций и классов, которые упрощают работу со строками.

```python
import string

print(string.ascii_lowercase)  # abcdefghijklmnopqrstuvwxyz
print(string.ascii_uppercase)  # ABCDEFGHIJKLMNOPQRSTUVWXYZ
print(string.digits)           # 0123456789
print(string.punctuation)      # !"#$%&'()*+,-./:;<=>?@[\]^_`{|}~
```

#### Генерация случайных чисел (random)

Модуль `random` позволяет генерировать случайные числа, выбирать случайные элементы из списка и перемешивать данные.

```python
import random

# Генерация случайного числа от 1 до 100
print("Случайное число от 1 до 100:", random.randint(1, 100))

# Выбор случайного элемента из списка
colors = ["красный", "синий", "зелёный", "жёлтый"]
print("Случайный цвет:", random.choice(colors))

# Перемешивание списка
numbers = [1, 2, 3, 4, 5]
random.shuffle(numbers)
print("Перемешанный список:", numbers)

# Генерация случайного числа с плавающей точкой
print("Случайное число от 0 до 1:", random.random())  # 0.56743
```

### Модуль `sys` – Работа с системными параметрами в Python

Модуль `sys (System-specific parameters and functions)` предоставляет функции и переменные для работы с интерпретатором Python.

С его помощью можно:

- Получить информацию о системе и версии Python
- Работать с аргументами командной строки
- Управлять путями поиска модулей (sys.path)
- Прерывать выполнение программы (sys.exit())

**Основные возможности `sys`**

Получение информации о системе

Модуль `sys` позволяет узнать текущую версию Python и путь к интерпретатору.

```python
import sys

print("Версия Python:", sys.version)
print("Платформа:", sys.platform)
print("Путь к интерпретатору:", sys.executable)
```

**Вывод примера на Windows:**

```sh
Версия Python: 3.10.6 (main, Jan 1 2024) 
Платформа: win32
Путь к интерпретатору: C:\Python\python.exe
```
**Вывод примера на Linux/macOS:**

```sh
Версия Python: 3.9.12 (main, Mar 8 2024)
Платформа: linux
Путь к интерпретатору: /usr/bin/python3
```

### Импорт внешних библиотек

Однако встроенных модулей иногда недостаточно. Например, в Python нет встроенных инструментов для работы с `HTTP-запросами` или анализа данных.
В таких случаях используются сторонние библиотеки, которые можно установить через `pip`.

Некоторые модули не входят в стандартную библиотеку Python. Их нужно установить через `pip`.

#### Что такое pip и зачем он нужен?

**pip ("Pip Installs Packages")** — это стандартный пакетный менеджер для Python, который позволяет устанавливать, обновлять и удалять сторонние библиотеки.

#### Почему pip важен?

В стандартной библиотеке Python есть много полезных модулей, но для сложных задач (работа с вебом, машинное обучение, базы данных) программисты создают сторонние библиотеки.

**Например:**

- requests – для работы с HTTP-запросами
- numpy – для научных вычислений
- django – для создания веб-приложений(Который мы будем изучать позже)

Без `pip` пришлось бы загружать библиотеки вручную и подключать их в проект!

Пример с библиотекой `requests`:

```sh
pip install requests  # Устанавливаем библиотеку
```
Теперь можно использовать её:

```python
import requests

response = requests.get("https://www.google.com")
print(response.status_code)  # 200 (если сайт доступен)
```

`requests` помогает делать `HTTP`-запросы, но без установки работать не будет!

## Удаление пакетов

Если библиотека больше не нужна, её можно удалить:

```sh
pip uninstall requests
```

### Как узнать, какие библиотеки установлены?

Чтобы посмотреть список установленных пакетов:

```sh
pip list
```

**Пример вывода:**

```sh
numpy  1.23.1
pandas  1.5.3
requests  2.28.1
```

## Комментарии и Docstrings

Комментарии и строковые литералы документации `(docstrings)` являются важными инструментами для написания чистого и понятного кода.

- Комментарии помогают объяснить логику кода.
- Docstrings служат для создания документации к модулям, классам и функциям.

### Комментарии в Python

Комментарии в Python начинаются с символа # и продолжаются до конца строки.
Python игнорирует комментарии при выполнении кода.

**Пример однострочных комментариев:**

```python
# Это комментарий
x = 5  # Комментарий после кода
```

**Комментарии внутри функций:**

```python
def factorial(n):
    # Инициализируем результат
    result = 1
    # Умножаем все числа от 1 до n
    for i in range(1, n + 1):
        result *= i
    return result
```

**Где это применяется?**

- Объяснение сложной логики
- Добавление примечаний к коду

### Многострочные комментарии

В Python можно использовать несколько строк.

```python
# Это многострочный комментарий.
# Он объясняет большой фрагмент кода.
# Используется для сложных алгоритмов.
```

### Docstring – документация в коде

**Docstring** – это строковый литерал в тройных кавычках (`"""` или `'''`), который пишется в начале функции, класса или модуля.

Пример `docstring` в функции:

```python
def add(a: int, b: int) -> int:
    """Возвращает сумму двух чисел."""
    return a + b
```

Получение документации в Python:

```python
print(add.__doc__)  # Возвращает сумму двух чисел.
help(add)  # Покажет описание функции
```

### Docstring в классах и методах

`Docstrings` можно использовать не только для функций, но и для классов и модулей.

Пример `docstring` в классе:

```python
class Dog:
    """
    Класс для представления собаки.

    Атрибуты:
        name (str): Имя собаки.
        age (int): Возраст собаки.

    Методы:
        bark(): Возвращает строку "Woof!".
    """

    def __init__(self, name: str, age: int):
        """Инициализирует объект Dog с именем и возрастом."""
        self.name = name
        self.age = age

    def bark(self) -> str:
        """Заставляет собаку лаять."""
        return "Woof!"
```

### Просмотр документации:

```python
print(Dog.__doc__)  # Покажет описание класса
print(Dog.bark.__doc__)  # Покажет описание метода
```

### Docstring для модулей

Файл Python `(.py)` может начинаться с `docstring`, который объясняет его назначение.

Пример `docstring` для модуля:

```python
"""
Этот модуль предоставляет функции для работы с геометрическими фигурами.

Функции:
    area_of_circle(radius) -- возвращает площадь круга.
    perimeter_of_square(side) -- возвращает периметр квадрата.
"""
def area_of_circle(radius: float) -> float:
    """Возвращает площадь круга с заданным радиусом."""
    from math import pi
    return pi * radius ** 2

def perimeter_of_square(side: float) -> float:
    """Возвращает периметр квадрата с заданной стороной."""
    return 4 * side
```

Вывод документации:

```python
import my_module
print(my_module.__doc__)  # Покажет описание модуля
```

### Стандарты docstring (Google, NumPy, reST)

В Python используются разные стандарты оформления `docstring`.

Наиболее популярные:

**Google-стиль docstring:**

```python
def multiply(a: int, b: int) -> int:
    """
    Умножает два числа.

    Args:
        a (int): Первое число.
        b (int): Второе число.

    Returns:
        int: Произведение a и b.
    """
    return a * b
```

**NumPy-стиль docstring:**

```python
def divide(a: int, b: int) -> float:
    """
    Разделение двух чисел.

    Parameters
    ----------
    a : int
        Делимое.
    b : int
        Делитель.

    Returns
    -------
    float
        Результат деления a на b.
    """
    return a / b
```

## PEP 8 – Руководство по стилю кода в Python

[PEP 8](https://peps.python.org/pep-0008/) (Python Enhancement Proposal 8) – это официальное руководство по стилю кода в Python. Оно определяет стандарты написания чистого и читаемого кода, которые приняты в сообществе Python.

### Почему важно следовать PEP 8?

- Единообразие кода – код становится понятным для всех разработчиков.
- Лёгкость поддержки – проще читать, исправлять и улучшать код.
- Инструменты автоматической проверки (flake8, black) используют PEP 8 как стандарт.

### Основные правила PEP 8

#### 1. Отступы (4 пробела, без табуляции)

Python использует отступы для обозначения блоков кода.

```python
def greet():
    print("Привет, мир!")  # 4 пробела
```
**Неправильный способ:**

```python
def greet():
	print("Привет, мир!")  # Табуляция (может сломаться в разных редакторах)
```

**Никогда не смешивайте табуляцию и пробелы!**

#### 2. Длина строки (максимум 79 символов)

Строки кода не должны превышать 79 символов, чтобы код был читаемым.

**Как правильно переносить длинные строки?**

1️. Используем \ (нежелательно)

```python
print("Это очень длинная строка, которая \
не должна выходить за пределы 79 символов.")
```

2️. Используем () (лучше)

```python
print(
    "Это длинный текст, который мы "
    "разбили на несколько строк."
)
```

### 3. Пробелы в выражениях

PEP 8 рекомендует использовать пробелы вокруг операторов, чтобы улучшить читаемость.

**Правильно**

```python
x = 5 + 10  # Пробелы вокруг `+`
y = (a + b) * (c - d)  # Пробелы внутри выражения
```

**Неправильно:**

```python
x=5+10  # Нет пробелов
y=(a+b)*(c-d)  # Всё слиплось
```

### 4. Именование переменных, функций и классов

Имена переменных и функций – snake_case

**Правильно:**

```python
user_age = 25
def calculate_salary():
    pass
```

**Неправильно:**

```python
UserAge = 25  # PascalCase нельзя для переменных
def CalculateSalary():  # CamelCase нельзя для функций
    pass
```

Имена классов – `PascalCase`

**Правильно:**

```python
class Employee:
    pass
```

**Неправильно:**

```python
class employee:  # Названия классов должны быть с большой буквы
    pass
```

Константы – `UPPER_CASE`

**Правильно:**

```python
PI = 3.14159
MAX_USERS = 1000
```

**Неправильно:**

```python
Pi = 3.14159  # Константы должны быть в верхнем регистре
```

### 5. Пустые строки для структуры кода

- Используйте 2 пустые строки между функциями и классами.
- Используйте 1 пустую строку внутри классов для разделения методов.

**Пример правильного кода:**

```python
class Person:
    def __init__(self, name):
        self.name = name

    def say_hello(self):
        print(f"Привет, меня зовут {self.name}")


def main():
    user = Person("Иван")
    user.say_hello()
```

### 6. Импорты

- Все импорты должны быть в начале файла.
- Сначала идут встроенные модули, затем сторонние, потом локальные.
- Не используйте `import *`!!!!!(Очень-очень плохая практика)

**Правильно:**

```python
import os
import sys

import requests  # Сторонние библиотеки

import my_module  # Локальные импорты
```

**Неправильно:**

```python
import requests
import os, sys  # Импорты в одной строке
from math import *  # Нельзя `import *`
```

## Практика

1. Напишите программу, которая запрашивает у пользователя радиус круга и вычисляет его площадь с использованием модуля `math`. Используйте число π из этого модуля.

2. Напишите программу, которая генерирует случайный пароль длиной 8 символов. Пароль должен содержать буквы (как строчные, так и заглавные) и цифры. Для генерации используйте модуль `random`.

3. Напишите программу, которая выводит текущую дату и время в формате `ДД.ММ.ГГГГ` `ЧЧ:ММ:СС`. Дополнительно программа должна вывести день недели. Используйте модуль `datetime`.

4. Напишите программу, которая вычисляет, сколько дней осталось до Нового года. Используйте модуль datetime для получения текущей даты и расчёта разницы с первым января следующего года.

5. Напишите программу, которая создаёт папку `new_folder` в текущей директории. Затем программа должна создать внутри этой папки файл `info.txt` и записать в него строку `"Hello, Python!"`. Используйте модуль `os`.

6. Напишите программу, которая запрашивает у пользователя имя файла и проверяет, существует ли этот файл в текущей директории. Если файл найден, программа должна вывести `"Файл существует!"`, в противном случае — "Файл не найден.". Используйте модуль `os`.

7. Напишите программу, которая имитирует бросок игрального кубика. При каждом запуске программа должна выводить случайное число от 1 до 6, представляющее выпавшее значение на кубике. Используйте модуль `random`.

8. Напишите программу, которая запрашивает у пользователя дробное число и выводит его округление вниз и вверх. Для округления используйте функции `math.floor()` и `math.ceil()` из модуля `math`.

9. Напишите программу, которая выбирает случайный день недели. Для этого создайте список дней недели и используйте модуль `random`, чтобы случайным образом выбрать один из них.

10. Напишите программу, которая запрашивает у пользователя две даты в формате `ГГГГ-ММ-ДД` и вычисляет разницу между ними в днях. Используйте модуль `datetime` для работы с датами.